x <- rnbinom(N, 10, .5)
hist(x,
xlim=c(min(x),max(x)), probability=T, nclass=max(x)-min(x)+1,
col='lightblue', xlab=' ', ylab=' ', axes=F,
main='Positive Skewed')
hist(rbeta(10000,5,2))
hist(rbeta(10000,2,5))
hist(rbeta(10000,5,5))
hist(rnorm(10000,0,1))
x<-rbeta(10000,mean=2,sd=5)
x<-rbeta(10000,2,5)
hist(x)
x<-rbeta(10000,5,5)
hist(x)
x<-rbeta(10000,5,2)
hist(x)
?rbeta
pnorm(0.025)
qnorm(0.025)
qnorm(0.025,lower.tail = F)
pnorm(1.96)
1.27359 / (0.5^2)
(0.5^2)/1.27359
1.27359 / (0.05^2)
0.05^2 * 177
x<-c(2,4,5,3,1,2,3,5)
y<-c(4,3,1,5,6,7,4,1)
lm(y~x)
summary(lm(y~x))
N    <- 1000
x    <- rnorm(N,10)
beta <- 3 + 0.4*rnorm(N)
y    <- 1 + x * beta + .75*rnorm(N)
df(x,y)
data.frame(x,y)
set.seed(1)
N    <- 1000
x    <- rnorm(N,10)
beta <- 2 + 0.5*rnorm(N)
y    <- 1 + x * beta + .75*rnorm(N)
data.frame(x,y)
pop<-data.frame(x,y)
length(pop)
length(pop$x)
set.seed(1)
N    <- 10000
x    <- rnorm(N,10)
beta <- 2 + 0.5*rnorm(N)
y    <- 1 + x * beta + .75*rnorm(N)
pop<-data.frame(x,y)
length(pop$x)
sample(pop,30,replace = F)
sample(pop[1,2],30,replace = F)
sample(pop,30,replace = F,2)
sampleData<-pop[sample(nrow(pop), 30), ]
sampleData
f <- function () {
fit <- lm(dist ~ speed, data = cars, subset = sample(nrow(cars), 30))
coef(fit)
}
set.seed(0); f()
set.seed(0); z <- t(replicate(50, f()))
head(z)   ## show first few rows
par(mfrow = c(1,2))
hist(z[,1], main = "intercept")
hist(z[,2], main = "slope")
f <- function () {
fit <- lm(dist ~ speed, data = cars, subset = sample(nrow(cars), 30))
coef(fit)
}
set.seed(0); f()
set.seed(0); z <- t(replicate(50, f()))
head(z)   ## show first few rows
par(mfrow = c(1,2))
hist(z[,1], main = "intercept")
hist(z[,2], main = "slope")
set.seed(0); f()
head(data)
head(cars)
length(cars)
length(cars$speed)
m1<-lm(dist ~ speed, data = cars)
print(m1)
set.seed(0); f()
f <- function () {
fit <- lm(dist ~ speed, data = cars, subset = sample(nrow(cars), 30))
coef(fit)
summary(fit)
}
set.seed(0); f()
0.05^2 * 177
1.27359 / (0.05^2)
1.27359 / (0.01^2)
1
1.27359 / (0.01^2)
1.27359 / (0.1^2)
pnorm(1.96)
qnorm(0.025,lower.tail = F)
pnorm(1.96, lower.tail = F)
pnorm(0.5)
pnorm(0)
?pnorm
pnorm(1, mean = 1, sd = 1, lower.tail = TRUE, log.p = FALSE)
rt(0)
rt(0,df=1)
rt(1,df=1)
rt(0,df=10)
pt(0, df=Inf)
pt(0, df=2)
pt(0, df=10)
pt(1, df=10)
pt(0, df=10)
pnorm(1)
pnorm(1)
pt(1, df=Inf)
pt(1, df=10)
qnorm(0.025,lower.tail = F)
qt(0.025,df=Inf,lower.tail = F)
qt(0.025,df=10,lower.tail = F)
load("C:/Users/akane/Desktop/Science/Manuscripts/Manx Shearwaters/Saskia Model Run/Take 2/Data_30012017.RData")
moddat1<-moddat[!is.na(moddat$forabin) & !is.na(moddat$chlora8day) & moddat$period=="CR" & moddat$chlora8day<30,]
moddat1$birdid<-as.factor(as.character(moddat1$birdid))
moddat1$tripid<-as.factor(as.character(moddat1$tripid))
moddat2<-moddat[!is.na(moddat$combin) & !is.na(moddat$chlora8day) & moddat$period=="CR" & moddat$chlora8day<30,]
moddat3<-moddat[!is.na(moddat$forabin) & !is.na(moddat$SST8day) & moddat$period=="CR",]
moddat3$birdid<-as.factor(as.character(moddat3$birdid))
moddat3$tripid<-as.factor(as.character(moddat3$tripid))
moddat4<-moddat[!is.na(moddat$combin) & !is.na(moddat$SST8day) & moddat$period=="CR",]
moddat5<-moddat[!is.na(moddat$forabin) & !is.na(moddat$bathy) & moddat$period=="CR" & moddat$bathy<0,]
moddat5$birdid<-as.factor(as.character(moddat5$birdid))
moddat5$tripid<-as.factor(as.character(moddat5$tripid))
moddat6<-moddat[!is.na(moddat$combin) & !is.na(moddat$bathy) & moddat$period=="CR" & moddat$bathy<0,]
##input second part
moddat7<-modrun[!is.na(modrun$forabin) & !is.na(modrun$chlora8day) ,]
moddat8<-modrun[!is.na(modrun$combin) & !is.na(modrun$chlora8day) ,]
moddat9<-modrun[!is.na(modrun$forabin) & !is.na(modrun$SST8day) ,]
moddat10<-modrun[!is.na(modrun$combin) & !is.na(modrun$SST8day) ,]
moddat11<-modrun[!is.na(modrun$forabin) & !is.na(modrun$bathy) & modrun$bathy<0,]
moddat12<-modrun[!is.na(modrun$combin) & !is.na(modrun$bathy)  & modrun$bathy<0,]
g1<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g2<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat2 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g3<-gamm(forabin~s(SST8day)+s(SST8day,by=group), data = moddat3,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g4<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat4,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g5<-gamm(forabin~ s(bathy)+ s(bathy,by=group), data = moddat5,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid),family=binomial)
#g6<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat6, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
##add to second run: models for period
g7<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=period), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g8<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat8 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g9<-gamm(forabin~s(SST8day)+s(SST8day,by=period), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g10<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat10,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g11<-gamm(forabin~ s(bathy)+ s(bathy,by=period), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g12<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat12, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g13<-gamm(forabin~s(log(chlora8day))+ s(log(chlora8day),by=period)+s(log(chlora8day),by=sex)+s(log(chlora8day),by=site)+s(log(chlora8day),by=year), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g15<-gamm(forabin~s(SST8day)+ s(SST8day,by=period)+ s(SST8day,by=sex)+ s(SST8day,by=site)+ s(SST8day,by=year), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g17<-gamm(forabin~ s(bathy)+ s(bathy,by=period)+s(bathy,by=sex)+s(bathy,by=site)+s(bathy,by=year), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
library("mgcv", lib.loc="C:/Program Files/R/R-3.3.1/library")
g1<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g1<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
moddat1<-moddat[!is.na(moddat$forabin) & !is.na(moddat$chlora8day) & moddat$period=="CR" & moddat$chlora8day<30,]
moddat1$birdid<-as.factor(as.character(moddat1$birdid))
moddat1$tripid<-as.factor(as.character(moddat1$tripid))
moddat2<-moddat[!is.na(moddat$combin) & !is.na(moddat$chlora8day) & moddat$period=="CR" & moddat$chlora8day<30,]
moddat3<-moddat[!is.na(moddat$forabin) & !is.na(moddat$SST8day) & moddat$period=="CR",]
moddat3$birdid<-as.factor(as.character(moddat3$birdid))
moddat3$tripid<-as.factor(as.character(moddat3$tripid))
moddat4<-moddat[!is.na(moddat$combin) & !is.na(moddat$SST8day) & moddat$period=="CR",]
moddat5<-moddat[!is.na(moddat$forabin) & !is.na(moddat$bathy) & moddat$period=="CR" & moddat$bathy<0,]
moddat5$birdid<-as.factor(as.character(moddat5$birdid))
moddat5$tripid<-as.factor(as.character(moddat5$tripid))
moddat6<-moddat[!is.na(moddat$combin) & !is.na(moddat$bathy) & moddat$period=="CR" & moddat$bathy<0,]
##input second part
moddat7<-modrun[!is.na(modrun$forabin) & !is.na(modrun$chlora8day) ,]
moddat8<-modrun[!is.na(modrun$combin) & !is.na(modrun$chlora8day) ,]
moddat9<-modrun[!is.na(modrun$forabin) & !is.na(modrun$SST8day) ,]
moddat10<-modrun[!is.na(modrun$combin) & !is.na(modrun$SST8day) ,]
moddat11<-modrun[!is.na(modrun$forabin) & !is.na(modrun$bathy) & modrun$bathy<0,]
moddat12<-modrun[!is.na(modrun$combin) & !is.na(modrun$bathy)  & modrun$bathy<0,]
g1<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g2<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat2 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g3<-gamm(forabin~s(SST8day)+s(SST8day,by=group), data = moddat3,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g4<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat4,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g5<-gamm(forabin~ s(bathy)+ s(bathy,by=group), data = moddat5,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid),family=binomial)
#g6<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat6, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
##add to second run: models for period
g7<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=period), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g8<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat8 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g9<-gamm(forabin~s(SST8day)+s(SST8day,by=period), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g10<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat10,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g11<-gamm(forabin~ s(bathy)+ s(bathy,by=period), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g12<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat12, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g13<-gamm(forabin~s(log(chlora8day))+ s(log(chlora8day),by=period)+s(log(chlora8day),by=sex)+s(log(chlora8day),by=site)+s(log(chlora8day),by=year), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g15<-gamm(forabin~s(SST8day)+ s(SST8day,by=period)+ s(SST8day,by=sex)+ s(SST8day,by=site)+ s(SST8day,by=year), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g17<-gamm(forabin~ s(bathy)+ s(bathy,by=period)+s(bathy,by=sex)+s(bathy,by=site)+s(bathy,by=year), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
library("mgcv", lib.loc="C:/Program Files/R/R-3.3.1/library")
g1<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g2<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat2 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g3<-gamm(forabin~s(SST8day)+s(SST8day,by=group), data = moddat3,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g4<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat4,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g5<-gamm(forabin~ s(bathy)+ s(bathy,by=group), data = moddat5,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid),family=binomial)
#g6<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat6, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
##add to second run: models for period
g7<-gamm(forabin~s(log(chlora8day))+s(log(chlora8day),by=period), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g8<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat8 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g9<-gamm(forabin~s(SST8day)+s(SST8day,by=period), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g10<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat10,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g11<-gamm(forabin~ s(bathy)+ s(bathy,by=period), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g12<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat12, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g13<-gamm(forabin~s(log(chlora8day))+ s(log(chlora8day),by=period)+s(log(chlora8day),by=sex)+s(log(chlora8day),by=site)+s(log(chlora8day),by=year), data = moddat7, random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g15<-gamm(forabin~s(SST8day)+ s(SST8day,by=period)+ s(SST8day,by=sex)+ s(SST8day,by=site)+ s(SST8day,by=year), data = moddat9,random=list(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g17<-gamm(forabin~ s(bathy)+ s(bathy,by=period)+s(bathy,by=sex)+s(bathy,by=site)+s(bathy,by=year), data = moddat11,randomlist(birdid=~1,tripid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
load("C:/Users/akane/Desktop/Science/Manuscripts/Manx Shearwaters/Saskia Model Run/Take 2/Data_30012017.RData")
g3<-gamm(forabin~s(SST8day)+s(SST8day,by=group), data = moddat3, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g1<-gamm(forabin~s(log(chlora8day),by=group), data = moddat1, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g1
summary(g1$lme)
plot(g1$gam)
summary(g1$gam)
g3<-gamm(forabin~ s(SST8day,by=group), data = moddat3, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g4<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat4,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g5<-gamm(forabin~ s(bathy,by=group), data = moddat5,random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid),family=binomial)
#g6<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat6, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
##add to second run: models for period
g7<-gamm(forabin~s(log(chlora8day),by=period), data = moddat7, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g8<-gamm(combin~s(log(chlora8day)),s(log(chlora8day),by=group), data = moddat8 ,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g9<-gamm(forabin~s(SST8day,by=period), data = moddat9,random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g10<-gamm(combin~s(SST8day)+s(SST8day,by=group), data = moddat10,random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g11<-gamm(forabin~ s(bathy,by=period), data = moddat11, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
#g12<-gamm(combin~ s(bathy)+ s(bathy,by=group), data = moddat12, random=list(as.factor(birdid)=~1,as.factor(tripid)=~1), correlation=corAR1(form=~tripseq|as.factor(birdid)/as.factor(tripid)), family=binomial)
g13<-gamm(forabin~ s(log(chlora8day),by=period)+s(log(chlora8day),by=sex)+s(log(chlora8day),by=site)+s(log(chlora8day),by=year), data = moddat7, random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g15<-gamm(forabin~ s(SST8day,by=period)+ s(SST8day,by=sex)+ s(SST8day,by=site)+ s(SST8day,by=year), data = moddat9,random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
g17<-gamm(forabin~ s(bathy,by=period)+s(bathy,by=sex)+s(bathy,by=site)+s(bathy,by=year), data = moddat11,random=list(birdid=~1), correlation=corAR1(form=~tripseq|birdid/tripid), family=binomial)
save.image("E:/Model Adam PC/Models_out.RData")
save.image("C:/Users/akane/Desktop/Science/Manuscripts/Manx Shearwaters/Saskia Model Run/Model_run_out.RData")
rm(list=ls())
setwd("C:\\Users\\akane\\Desktop\\Science\\Manuscripts\\Documentary analysis\\Documentary-analysis")
data<-read.csv("names.csv", header = T, sep = ",")
head(data)
length(data$name)
data.new<-data[!duplicated(data), ]
length(data.new)
class(data.new)
get_maf <- function(x){article_pageviews(project = "en.wikipedia", article = x
, start = as.Date('2016-01-01'), end = as.Date("2016-12-31")
, user_type = "user", platform = c("desktop", "mobile-web"))
}
get_wiki <- function(x){article_pageviews(project = "en.wikipedia", article = x
, start = as.Date('2016-01-01'), end = as.Date("2016-12-31")
, user_type = "user", platform = c("desktop", "mobile-web"))
}
output<-data.new %>%  get_wiki
library(dplyr)
library(pageviews)
output<-data.new %>%  get_wiki
output
length(output)
tail(output)
head(output)
output$access<-as.factor(output$access)
class(output$access)
plot(output$date[output$agent=="user"],output$views[output$agent=="user"], col=output$access[output$agent=="user"], pch = 16)
plot(output$date[output$agent=="user"],output$views[output$agent=="user"], col=output$access[output$agent=="user"],
pch = 16, xlab = "time", ylab = "hits")
plot(output$date[output$agent=="user" & output$article=="Sloth"],output$views[output$agent=="user"& output$article=="Sloth"], col=output$access[output$agent=="user"& output$article=="Sloth"],
pch = 16, xlab = "time", ylab = "hits")
legend(topright # places a legend at the appropriate place
c("desktop","mobile-web"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue","red")) # gives the legend lines the correct color and width
legend(topright, # places a legend at the appropriate place
c("desktop","mobile-web"), # puts text in the legend
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=c("blue","red")) # gives the legend lines the correct color and width
legend(Jan, 2000, legend=c("desktop", "mobile-web"),
col=c("black", "red"), lty=1:2, cex=0.8)
legend(12, 2000, legend=c("desktop", "mobile-web"),
col=c("black", "red"), lty=1:2, cex=0.8)
output$date
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), lty=1:2, cex=0.8)
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8)
plot(output$date[output$agent=="user" & output$article=="Sloth"],output$views[output$agent=="user"& output$article=="Sloth"], col=output$access[output$agent=="user"& output$article=="Sloth"],
pch = 16, xlab = "time", ylab = "hits")
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8)
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
plot(output$date[output$agent=="user" & output$article=="Sloth"],output$views[output$agent=="user"& output$article=="Sloth"], col=output$access[output$agent=="user"& output$article=="Sloth"],
pch = 16, xlab = "time", ylab = "hits")
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
head(data)
# plot individual species
plot(output$date[output$agent=="user" & output$article=="Sifaka"],output$views[output$agent=="user"& output$article=="Sifaka"], col=output$access[output$agent=="user"& output$article=="Sifaka"],
pch = 16, xlab = "time", ylab = "hits")
# add a legend
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
head(output)
strftime(output$date, format = "%w")
head(output)
strftime(output$date, format = "%j")
strftime(output$date, format = "%m")
output$month<-strftime(output$date, format = "%m")
head(output)
output %>%
group_by(month) %>%
summarise(views = sum(views))
max(output$views)
output$month<-strftime(output$date[output$access=="mobile-web"], format = "%m")
head(output)
output$month<-strftime(output$date, format = "%m")
output[output$access=="mobile-web"] %>%
group_by(month) %>%
summarise(views = sum(views))
output$access=="mobile-web"
# group views by month
output[output$access=="mobile-web"] %>%
group_by(month) %>%
summarise(views = sum(views[output$access=="mobile-web"]))
mobileOutput <- output[output$access=="mobile-web"]
mobileOutput <- output[output$access=="mobile-web" , ]
mobileOutput<-droplevels(mobileOutput)
head(mobileOutput)
# group views by month
mobileOutput %>%
group_by(month) %>%
summarise(views = sum(views))
# group views by month
mobileOutputSummary<-mobileOutput %>%
group_by(month) %>%
summarise(views = sum(views))
class(mobileOutputSummary)
head(mobileOutputSummary)
boxplot(mobileOutputSummary$month, mobileOutputSummary$views)
mobileOutputSummary<-as.data.frame(mobileOutputSummary)
class(mobileOutputSummary)
head(mobileOutputSummary)
boxplot(mobileOutputSummary$month, mobileOutputSummary$views)
boxplot(mobileOutputSummary)
mobileOutputSummary
boxplot(mobileOutputSummary$month ~ mobileOutputSummary$views)
boxplot(mobileOutputSummary$views ~ mobileOutputSummary$month)
plot(mobileOutputSummary$views ~ mobileOutputSummary$month)
plot(mobileOutputSummary$views ~ mobileOutputSummary$month, pch = 16)
plot(mobileOutputSummary$views ~ mobileOutputSummary$month, pch = 16)
plot(mobileOutputSummary$views ~ mobileOutputSummary$month, pch = 16, xlab="month", ylab="hits")
plot(output$date[output$agent=="user" & output$article=="Lion"],output$views[output$agent=="user"& output$article=="Lion"], col=output$access[output$agent=="user"& output$article=="Lion"],
pch = 16, xlab = "time", ylab = "hits")
# plot individual species
plot(output$date[output$agent=="user" & output$article=="Elephant"],output$views[output$agent=="user"& output$article=="Elephant"], col=output$access[output$agent=="user"& output$article=="Elephant"],
pch = 16, xlab = "time", ylab = "hits")
# plot individual species
plot(output$date[output$agent=="user" & output$article=="Iguana"],output$views[output$agent=="user"& output$article=="Iguana"], col=output$access[output$agent=="user"& output$article=="Iguana"],
pch = 16, xlab = "time", ylab = "hits")
plot(output$date[output$agent=="user" & output$article=="Iguana"],output$views[output$agent=="user"& output$article=="Iguana"], col=output$access[output$agent=="user"& output$article=="Iguana"],
pch = 16, xlab = "time", ylab = "hits", ylim = c(0,5000))
# add a legend
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
plot(output$date[output$agent=="user" & output$article=="Shrike"],output$views[output$agent=="user"& output$article=="Shrike"], col=output$access[output$agent=="user"& output$article=="Shrike"],
pch = 16, xlab = "time", ylab = "hits")
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
# plot individual species
plot(output$date[output$agent=="user" & output$article=="Flamingo"],output$views[output$agent=="user"& output$article=="Flamingo"], col=output$access[output$agent=="user"& output$article=="Flamingo"],
pch = 16, xlab = "time", ylab = "hits")
# add a legend
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
# plot individual species
plot(output$date[output$agent=="user" & output$article=="Bee-eater"],output$views[output$agent=="user"& output$article=="Bee-eater"], col=output$access[output$agent=="user"& output$article=="Bee-eater"],
pch = 16, xlab = "time", ylab = "hits")
# add a legend
legend("topright", legend=c("desktop", "mobile-web"),
col=c("black", "red"), cex=0.8, pch = 16)
plot(mobileOutputSummary$views ~ mobileOutputSummary$month, pch = 16, xlab="month", ylab="hits")
# desktop data only
desktopOutput <- output[output$access=="desktop" , ]
desktopOutput<-droplevels(desktopOutput)
head(desktopOutput)
# group views by month
desktopOutputSummary<-desktopOutput %>%
group_by(month) %>%
summarise(views = sum(views))
desktopOutputSummary<-as.data.frame(desktopOutputSummary)
# plot views by month for mobile access
plot(desktopOutputSummary$views ~ desktopOutputSummary$month, pch = 16, xlab="month", ylab="hits")
max(output$views[output$access=="desktop"])
max(output$views[output$access=="mobile-web"])
max(desktopOutput)
head(desktopOutput)
head(desktopOutputSummary)
max(desktopOutputSummary$views)
max(mobileopOutputSummary$views)
max(mobileOutputSummary$views)
write.csv(output, file = "output.csv",row.names=FALSE)
mobileOutputSummary
mobileOutput
# group views by month
mobileOutputSummary<-mobileOutput %>%
group_by(month, article) %>%
summarise(views = sum(views))
mobileOutputSummary<-as.data.frame(mobileOutputSummary)
mobileOutputSummary
mobileOutputSummarySpecies<-mobileOutput %>%
group_by(month, article) %>%
summarise(views = sum(views))
mobileOutputSummarySpecies<-as.data.frame(mobileOutputSummarySpecies)
mobileOutputSummarySpecies
desktopOutputSummarySpecies<-desktopOutput %>%
group_by(month) %>%
summarise(views = sum(views))
desktopOutputSummarySpecies<-as.data.frame(desktopOutputSummarySpecies)
desktopOutputSummarySpecies
# desktop data
desktopOutputSummarySpecies<-desktopOutput %>%
group_by(month, article) %>%
summarise(views = sum(views))
desktopOutputSummarySpecies<-as.data.frame(desktopOutputSummarySpecies)
desktopOutputSummarySpecies
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Albatross"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Albatross"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Sloth"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Sloth"],
pch = 16, xlab="month", ylab="hits")
mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Sloth"]
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Flamingo"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Flamingo"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Iguana"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Iguana"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Penguin"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Penguin"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Pygmy_three-toed_sloth"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Pygmy_three-toed_sloth"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Peregrine_falcon"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Peregrine_falcon"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Noddy_(tern)"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Noddy_(tern)"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Marine_iguana"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Marine_iguana"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Komodo_dragon"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Komodo_dragon"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Harris's_hawk"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Harris's_hawk"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Nubian_ibex"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Nubian_ibex"],
pch = 16, xlab="month", ylab="hits")
mobileOutputSummarySpecies
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Chinstrap_penguin"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Chinstrap_penguin"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Indri"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Indri"],
pch = 16, xlab="month", ylab="hits")
mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Indri"]
mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Chinstrap_penguin"]
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Barn_owl"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Barn_owl"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Racoon"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Racoon"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Marine_iguana"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Marine_iguana"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Desert_long-eared_bat"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Desert_long-eared_bat"],
pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummarySpecies$views[mobileOutputSummarySpecies$article=="Desert_long-eared_bat"] ~
mobileOutputSummarySpecies$month[mobileOutputSummarySpecies$article=="Desert_long-eared_bat"],
pch = 16, xlab="month", ylab="hits")
output$week<-strftime(output$date, format = "%w")
head(output)
output$week<-strftime(output$date, format = "%W")
head(output)
write.csv(output, file = "output.csv",row.names=FALSE)
mobileOutputSummaryWeekly<-mobileOutput %>%
group_by(week) %>%
summarise(views = sum(views))
mobileOutputSummaryWeekly<-as.data.frame(mobileOutputSummaryWeekly)
# mobile data only
mobileOutput <- output[output$access=="mobile-web" , ]
mobileOutput<-droplevels(mobileOutput)
head(mobileOutput)
# group views by week
mobileOutputSummaryWeekly<-mobileOutput %>%
group_by(week) %>%
summarise(views = sum(views))
mobileOutputSummaryWeekly<-as.data.frame(mobileOutputSummaryWeekly)
mobileOutputSummaryWeekly
# group views by week and species
mobileOutputSummaryWeekly<-mobileOutput %>%
group_by(week, article) %>%
summarise(views = sum(views))
mobileOutputSummaryWeekly<-as.data.frame(mobileOutputSummaryWeekly)
mobileOutputSummaryWeekly
plot(desktopOutputSummary$views ~ desktopOutputSummary$week, pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummaryWeekly$views ~ mobileOutputSummaryWeekly$week, pch = 16, xlab="month", ylab="hits")
plot(mobileOutputSummaryWeekly$views[mobileOutputSummaryWeekly$article=="Desert_long-eared_bat"] ~
mobileOutputSummaryWeekly$week[mobileOutputSummaryWeekly$article=="Desert_long-eared_bat"],
pch = 16, xlab="week", ylab="hits")
